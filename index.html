<!DOCTYPE html>

<html>
	<head>
		<title>24h v√©lo LLN (2023)</title>
		<meta charset="utf-8">

		<script src="models/kap.js"></script>
		<script src="index.js"></script>

		<style>
			body {
				margin: 0;
				padding: 0;
				overflow: hidden;
			}

			.overlay {
				width: 100vw;
				height: 100vh;
				position: absolute;
			}

			.cse-warning {
				display: flex;
				align-items: center;
				justify-content: space-around;
				flex-direction: column;
				color: red;
			}

			/* XXX yeah a little hacky ig */

			div[hidden] {
				display: none;
			}
		</style>

		<!-- surface shader -->

		<script id="surf-vert" type="x-shader/x-vertex">#version 300 es
			precision mediump float;

			layout(location = 0) in vec2 a_pos;
			layout(location = 1) in vec2 a_tex;

			uniform vec2 scale;
			uniform vec2 pos;

			out vec3 tex_coord;

			void main(void) {
				tex_coord = a_tex_coord;
				gl_Position = scale * a_pos + pos;
			}
		</script>

		<script id="surf-frag" type="x-shader/x-fragment">#version 300 es
			precision mediump float;
			precision lowp int;

			in vec3 pos;
			in vec4 world_pos;
			in vec3 colour;

			out vec4 frag_colour;

			void main(void) {
				frag_colour = vec4(colour / 2.0 + 0.5, 1.0);
			}
		</script>

		<!-- KAP shader -->

		<script id="kap-vert" type="x-shader/x-vertex">#version 300 es
			precision mediump float;

			layout(location = 0) in vec3 a_pos;
			layout(location = 1) in vec3 a_normal;

			uniform mat4 u_model;
			uniform mat4 u_vp;

			out vec3 pos;
			out vec4 world_pos;
			out vec3 colour;

			void main(void) {
				pos = a_pos;
				world_pos = u_model * vec4(pos, 1.0);
				gl_Position = u_vp * world_pos;
				colour = a_normal;
			}
		</script>

		<script id="kap-frag" type="x-shader/x-fragment">#version 300 es
			precision mediump float;
			precision lowp int;

			in vec3 pos;
			in vec4 world_pos;
			in vec3 colour;

			out vec4 frag_colour;

			void main(void) {
				frag_colour = vec4(colour / 2.0 + 0.5, 1.0);
			}
		</script>
	</head>
	<body>
		<!-- TODO confirm resolution -->
		<canvas id="canvas" class="overlay" width="960" height="576"></canvas>

		<div class="overlay cse-warning" id="cse-warning" hidden>
			<h3>Avertissement du CSE</h3>
			<h1 id="cse-warning-text"></h1>
		</div>

		<div class="overlay cse-warning" id="cse-edit-warning" hidden>
			<h3>Modifier l'avertissement du CSE</h3>
			<input type="text" id="cse-warning-input" value="Ceci est un message de test"></input>
			<button onclick="big_screen.change_state('c')">Afficher le message</button>
		</div>
	</body>
</html>
